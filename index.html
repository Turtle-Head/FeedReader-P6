<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>UdaciFeeds React</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,100,300,700">
    <style>
      body { font-family: 'Roboto', sans-serif; background: #f8f8f8; margin: 0; }
      .header { background: #222; color: #fff; padding: 1em; display: flex; align-items: center; }
      .menu-icon-link { color: #fff; margin-right: 1em; font-size: 2em; cursor: pointer; text-decoration: none; }
      .slide-menu { position: fixed; left: 0; top: 0; bottom: 0; width: 250px; background: #333; color: #fff; transform: translateX(-100%); transition: transform 0.3s; z-index: 10; }
      .slide-menu.open { transform: translateX(0); }
      .slide-menu ul { list-style: none; padding: 0; margin: 0; }
      .slide-menu li { border-bottom: 1px solid #444; }
      .slide-menu a { color: #fff; display: block; padding: 1em; text-decoration: none; }
      .slide-menu a.active { background: #444; }
      .feed { margin-left: 0; padding: 2em 1em 1em 1em; max-width: 700px; margin: 2em auto 0 auto; }
      .entry { background: #fff; margin-bottom: 1em; padding: 1em; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.07); }
      .entry-link { color: inherit; text-decoration: none; }
      .score { font-size: 1.2em; font-weight: bold; text-align: center; margin: 1em 0; }
      @media (min-width: 700px) {
        .feed { padding-left: 2em; padding-right: 2em; }
      }
    </style>
    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">

const allFeeds = [
  {
    name: "Udacity Blog",
    url: "https://blog.udacity.com/feed"
  }, {
    name: "CSS Tricks",
    url: "https://css-tricks.com/feed"
  }, {
    name: "HTML5 Rocks",
    url: "https://feeds.feedburner.com/html5rocks"
  }, {
    name: "Linear Digressions",
    url: "https://feeds.feedburner.com/udacity-linear-digressions"
  }
];

function fetchFeed(url) {
  // Udacity's proxy for RSS to JSON
  return fetch("https://rsstojson.udacity.com/parseFeed", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ url })
  })
    .then(res => res.json())
    .then(data => data.feed && data.feed.entries ? data.feed.entries : []);
}

function Menu({ feeds, currentFeed, onSelect, open, onClose }) {
  return (
    <nav className={`slide-menu${open ? " open" : ""}`}>
      <ul>
        {feeds.map((feed, idx) => (
          <li key={feed.url}>
            <a
              href="#"
              className={currentFeed === idx ? "active" : ""}
              onClick={e => { e.preventDefault(); onSelect(idx); onClose(); }}
            >
              {feed.name}
            </a>
          </li>
        ))}
      </ul>
    </nav>
  );
}

function Header({ onMenuClick }) {
  return (
    <div className="header">
      <a href="#" className="menu-icon-link" onClick={e => { e.preventDefault(); onMenuClick(); }}>
        <span role="img" aria-label="menu">&#9776;</span>
      </a>
      <h1 style={{margin: 0}}>Feeds</h1>
    </div>
  );
}

function Feed({ entries }) {
  if (!entries.length) return <div>Loading...</div>;
  return (
    <div className="feed">
      {entries.map((entry, i) => (
        <a className="entry-link" href={entry.link} target="_blank" rel="noopener noreferrer" key={i}>
          <article className="entry">
            <h2>{entry.title}</h2>
            <p dangerouslySetInnerHTML={{__html: entry.contentSnippet || entry.content || ""}} />
          </article>
        </a>
      ))}
    </div>
  );
}

function Scoreboard({ feedName, entriesCount }) {
  return (
    <div className="score">
      <span>Feed: <b>{feedName}</b></span> &nbsp;|&nbsp;
      <span>Entries: <b>{entriesCount}</b></span>
    </div>
  );
}

function App() {
  const [menuOpen, setMenuOpen] = React.useState(false);
  const [currentFeed, setCurrentFeed] = React.useState(0);
  const [entries, setEntries] = React.useState([]);
  const [loading, setLoading] = React.useState(true);

  React.useEffect(() => {
    setLoading(true);
    fetchFeed(allFeeds[currentFeed].url)
      .then(setEntries)
      .finally(() => setLoading(false));
  }, [currentFeed]);

  return (
    <>
      <Header onMenuClick={() => setMenuOpen(open => !open)} />
      <Menu
        feeds={allFeeds}
        currentFeed={currentFeed}
        onSelect={setCurrentFeed}
        open={menuOpen}
        onClose={() => setMenuOpen(false)}
      />
      <Scoreboard feedName={allFeeds[currentFeed].name} entriesCount={entries.length} />
      {loading ? <div style={{textAlign: "center"}}>Loading...</div> : <Feed entries={entries} />}
    </>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
  </body>
</html>